<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DRFMedia Timeline</title>
  <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <style>
    /* Background image + overlay */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(
          rgba(10, 25, 41, 0.7),
          rgba(10, 25, 41, 0.7)
        ),
        url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1470&q=80')
          no-repeat center center fixed;
      background-size: cover;
      min-height: 100vh;
      margin: 0;
      padding: 2rem 1rem;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .like-btn {
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .like-btn:hover {
      transform: scale(1.3);
    }

    /* Scrollbar for modal if content is big */
    #profileModal > div {
      max-height: 80vh;
      overflow-y: auto;
    }

    /* Custom scroll for modal content */
    #profileModal > div::-webkit-scrollbar {
      width: 8px;
    }
    #profileModal > div::-webkit-scrollbar-thumb {
      background-color: #22d3ee;
      border-radius: 10px;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center py-8 px-4 text-white">

  <h1 class="text-4xl font-extrabold mb-8 text-cyan-400 drop-shadow-lg text-center">
    DRFMedia Timeline
  </h1>

  <div
    id="profilesList"
    class="max-w-6xl w-full grid gap-8 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"
  ></div>

  <!-- Profile Modal -->
  <div
    id="profileModal"
    class="fixed inset-0 bg-black bg-opacity-70 hidden justify-center items-center z-50 p-4"
  >
    <div
      class="bg-gradient-to-br from-cyan-700 to-blue-900 rounded-lg shadow-xl max-w-md w-full p-6 relative border-2 border-cyan-400"
    >
      <button
        id="closeModalBtn"
        class="absolute top-3 right-3 text-cyan-200 hover:text-white text-3xl font-bold transition-colors"
        title="Close"
      >
        &times;
      </button>
      <div class="flex flex-col items-center space-y-4">
        <img
          id="modalPhoto"
          src=""
          alt="Profile Photo"
          class="w-32 h-32 rounded-full object-cover border-4 border-cyan-400 shadow-lg"
        />
        <h2 id="modalName" class="text-3xl font-semibold text-white"></h2>
        <p id="modalBio" class="text-cyan-200 text-center"></p>
        <p class="text-sm text-cyan-300 break-words">
          <strong>Wallet:</strong> <span id="modalWallet"></span>
        </p>
        <p class="text-xs text-cyan-400 italic mt-2 break-words">
          CID: <span id="modalCID"></span>
        </p>
      </div>
    </div>
  </div>

  <script>
    // Sample profiles (you can replace or load dynamically from IPFS later)
    const sampleProfiles = [
      {
        cid: "Qma2xRw2Zki2CsBZJVWTYksfCwQCvptmHhxWwmyHzXG4Ve",
        name: "Hassan Fayaz",
        bio: "HASSN Fayaaz",
        wallet: "0zahf9weh9fih94hf9ah498fhawhef98wfoafh9owafh90ftj098woef",
        image:
          "https://ipfs.io/ipfs/QmYgCNEzXQr5TfHPDWvME4r1VjdLqRS9Kw6xNmXAYYCQ6P",
      },
      {
        cid: "QmXkE9VPx9DyGNg3DQUqMRzqfbFqjyNJrGTkqtEJipDbwp",
        name: "Aisha K",
        bio: "Digital artist & blockchain enthusiast",
        wallet: "0xabc1234def5678ghijklmnopqrstuvwx",
        image:
          "https://ipfs.io/ipfs/QmWf6VHLT4z5Mw5jTqLhvR8Z5UuRJwPiKaVuXoJj5xWfBq",
      },
      {
        cid: "QmQz1ZDg9rXjqM9vKjvX3sHpTphm8JDw2ZEdDpCQ7vJo4A",
        name: "Omar Z",
        bio: "Crypto trader & coder",
        wallet: "0x9876543210fedcba09876543210fedcba",
        image:
          "https://ipfs.io/ipfs/QmQmCy6LPhfEmHfKhQH2GHS8NwS2gVmW5B4MjaEqGmK5Rj",
      },
    ];

    // Likes stored in localStorage by CID
    const likesKey = "drfmedia_likes";
    let likesData = JSON.parse(localStorage.getItem(likesKey)) || {};

    // Shorten wallet address for display
    function shortWallet(addr) {
      if (!addr) return "";
      return addr.slice(0, 6) + "..." + addr.slice(-4);
    }

    // Render all profiles on the page
    function renderProfiles() {
      const container = document.getElementById("profilesList");
      container.innerHTML = "";

      sampleProfiles.forEach((profile) => {
        const likeCount = likesData[profile.cid] || 0;

        const card = document.createElement("div");
        card.className =
          "bg-gradient-to-br from-cyan-800 to-blue-900 rounded-xl shadow-xl p-6 flex flex-col items-center text-center transform transition duration-300 hover:scale-105";

        card.innerHTML = `
          <img
            src="${profile.image}"
            alt="${profile.name}'s photo"
            class="w-28 h-28 rounded-full object-cover border-4 border-cyan-400 mb-4 shadow-lg"
          />
          <h3 class="text-2xl font-bold mb-1 text-white">${profile.name}</h3>
          <p class="text-cyan-300 mb-3 line-clamp-2">${profile.bio || ""}</p>
          <p class="text-sm text-cyan-400 mb-4 break-words">${shortWallet(profile.wallet)}</p>
          <button class="bg-cyan-500 hover:bg-cyan-600 text-white px-5 py-2 rounded-lg mb-4 transition">
            View Profile
          </button>
          <div class="flex items-center space-x-3">
            <button class="like-btn text-red-500 text-3xl" aria-label="Like" data-cid="${profile.cid}">❤️</button>
            <span class="text-cyan-300 font-semibold text-xl" id="likeCount-${profile.cid}">${likeCount}</span>
          </div>
        `;

        container.appendChild(card);

        // Attach event listeners to buttons inside this card:
        const viewBtn = card.querySelector("button");
        const likeBtn = card.querySelector(".like-btn");

        viewBtn.addEventListener("click", () => openProfileModal(profile.cid));
        likeBtn.addEventListener("click", () => incrementLike(profile.cid));
      });
    }

    // Show modal with profile info
    function openProfileModal(cid) {
      const profile = sampleProfiles.find((p) => p.cid === cid);
      if (!profile) return alert("Profile not found");

      document.getElementById("modalPhoto").src = profile.image;
      document.getElementById("modalName").textContent = profile.name;
      document.getElementById("modalBio").textContent = profile.bio || "(No bio)";
      document.getElementById("modalWallet").textContent = profile.wallet;
      document.getElementById("modalCID").textContent = cid;

      const modal = document.getElementById("profileModal");
      modal.classList.remove("hidden");
      modal.style.display = "flex";
    }

    // Close modal
    document.getElementById("closeModalBtn").addEventListener("click", () => {
      const modal = document.getElementById("profileModal");
      modal.style.display = "none";
      modal.classList.add("hidden");
    });

    // Like increment handler
    function incrementLike(cid) {
      likesData[cid] = (likesData[cid] || 0) + 1;
      localStorage.setItem(likesKey, JSON.stringify(likesData));
      document.getElementById(`likeCount-${cid}`).textContent = likesData[cid];
    }

    // Initial render
    renderProfiles();
  </script>
</body>
</html>
