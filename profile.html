<!-- profile.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DRF Profile</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body style="font-family: sans-serif; background: #f4f9f7;">
  <div class="container" style="max-width: 600px; margin: auto; text-align: center;">
    <h2>Welcome to DRF Wallet Mini Facebook</h2>
    <p id="walletInfo"></p>

    <div>
      <input type="text" id="userName" placeholder="Enter your Name" />
      <input type="file" id="profileImage" />
      <button onclick="saveProfile()">Save Profile</button>
    </div>

    <hr />

    <textarea id="postContent" placeholder="What's on your mind?" rows="4" style="width: 100%; margin-top: 10px;"></textarea>
    <br />
    <button onclick="createPost()">Post</button>
  </div>

  <script>
    const wallet = localStorage.getItem("drf_active_wallet") || "0x0000000000000000000000000000000000000000";
    document.getElementById("walletInfo").textContent = `Logged in as: ${wallet}`;

    function saveProfile() {
      const name = document.getElementById("userName").value;
      const file = document.getElementById("profileImage").files[0];

      if (!name || !file) return alert("Name and Profile Image required!");

      const reader = new FileReader();
      reader.onload = function (e) {
        const imageUrl = e.target.result;
        localStorage.setItem("drf_profile", JSON.stringify({ name, imageUrl, wallet }));
        alert("Profile saved!");
      };
      reader.readAsDataURL(file);
    }

    function createPost() {
      const content = document.getElementById("postContent").value;
      if (!content) return alert("Post content cannot be empty!");

      const profile = JSON.parse(localStorage.getItem("drf_profile"));
      if (!profile) return alert("Please create your profile first!");

      const posts = JSON.parse(localStorage.getItem("drf_posts")) || [];

      posts.unshift({
        wallet,
        name: profile.name,
        profileUrl: profile.imageUrl,
        content,
        timestamp: new Date().toLocaleString(),
        reactions: 0,
        comments: []
      });

      localStorage.setItem("drf_posts", JSON.stringify(posts));
      alert("Post created!");

      document.getElementById("postContent").value = "";
    }
  </script>
</body>
</html>
