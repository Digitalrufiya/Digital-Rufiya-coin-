async function createAccount() {
  const password = prompt("Set a password to encrypt your wallet:");
  if (!password) return alert("Password is required.");
  showLoading("Creating your DRF Wallet... Please wait");

  try {
    const wallet = ethers.Wallet.createRandom();
    const secretPhrase = wallet.mnemonic.phrase;
    alert("Account created! Your secret phrase:\n\n" + secretPhrase + "\n\nSave it securely.");

    const downloadLink = document.createElement('a');
    downloadLink.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(secretPhrase);
    downloadLink.download = "drf_wallet_secret_phrase.txt";
    document.body.appendChild(downloadLink);
    downloadLink.click();
    document.body.removeChild(downloadLink);

    const encryptedJson = await wallet.encrypt(password);  // Default, no extra options
    localStorage.setItem("drf_encrypted_wallet", encryptedJson);
    window.location.href = "dashboard.html";
  } catch (err) {
    alert("Failed to create wallet: " + err.message);
    location.reload();
  }
}

async function recoverAccount() {
  const phrase = prompt("Enter your 12-word secret phrase:");
  if (!phrase || phrase.trim().split(" ").length !== 12) return alert("Invalid phrase.");
  const password = prompt("Set a password to encrypt recovered wallet:");
  if (!password) return alert("Password is required.");

  showLoading("Recovering your DRF Wallet... Please wait");

  try {
    const wallet = ethers.Wallet.fromMnemonic(phrase.trim());
    const encryptedJson = await wallet.encrypt(password);  // Simplified for mobile
    localStorage.setItem("drf_encrypted_wallet", encryptedJson);
    alert("Wallet recovered successfully!");
    window.location.href = "dashboard.html";
  } catch (err) {
    alert("Recovery failed: " + err.message);
    location.reload();
  }
}
