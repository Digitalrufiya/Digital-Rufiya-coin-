<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DRFTube Upload Test</title>
</head>
<body>
  <h1>Upload to IPFS (Pinata)</h1>
  <input type="file" id="videoFile" accept="video/*"><br><br>
  <input type="text" id="title" placeholder="Title"><br><br>
  <textarea id="description" placeholder="Description"></textarea><br><br>
  <button onclick="uploadVideo()">Upload Video</button>

  <script>
    async function uploadVideo() {
      const file = document.getElementById("videoFile").files[0];
      const title = document.getElementById("title").value;
      const description = document.getElementById("description").value;

      if (!file || !title) {
        alert("Please select a file and enter title");
        return;
      }

      const formData = new FormData();
      formData.append("file", file);

      try {
        const res = await fetch("https://api.pinata.cloud/pinning/pinFileToIPFS", {
          method: "POST",
          headers: {
            Authorization: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiI2YjI3MmJhYy00ZTg5LTQxMzUtOWRlMS1iYzk3OTkzMjBkY2YiLCJlbWFpbCI6ImRpZ2l0YWxydWZpeWFjb2luQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJwaW5fcG9saWN5Ijp7InJlZ2lvbnMiOlt7ImRlc2lyZWRSZXBsaWNhdGlvbkNvdW50IjoxLCJpZCI6IkZSQTEifSx7ImRlc2lyZWRSZXBsaWNhdGlvbkNvdW50IjoxLCJpZCI6Ik5ZQzEifV0sInZlcnNpb24iOjF9LCJtZmFfZW5hYmxlZCI6ZmFsc2UsInN0YXR1cyI6IkFDVElWRSJ9LCJhdXRoZW50aWNhdGlvblR5cGUiOiJzY29wZWRLZXkiLCJzY29wZWRLZXlLZXkiOiJjNmZlNzk2ZjY0YjhlNWI3ZDI1NiIsInNjb3BlZEtleVNlY3JldCI6ImNhNmVkZmIyYzJhNjkzNzYwZGY1NWRhNTJlOTkwMWY1Yjk0Y2EzZjE0ZTI0NmQ0ZWJkMjQxNWE3ZjM3YjhkMWUiLCJleHAiOjE3ODE0MjAyNDF9.jTvLgxmAWy9AYsxFHVVaX4e1086fiQ09txSJo_-TyU4"
          },
          body: formData
        });

        if (!res.ok) throw new Error("Upload failed");

        const result = await res.json();
        const ipfsUrl = `https://gateway.pinata.cloud/ipfs/${result.IpfsHash}`;

        alert("Video uploaded!\n\nIPFS URL:\n" + ipfsUrl);
        console.log("IPFS URL:", ipfsUrl);
      } catch (err) {
        console.error(err);
        alert("Error uploading to IPFS.");
      }
    }
  </script>
</body>
</html>
