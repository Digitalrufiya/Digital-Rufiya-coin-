<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DRF Timeline</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; background: #f5f5f5; padding: 20px; }
    .post { background: #fff; padding: 15px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .post img, .post video { max-width: 100%; border-radius: 5px; }
    .description { margin-top: 10px; color: #333; }
    .date { font-size: 12px; color: #888; margin-top: 5px; }
  </style>
</head>
<body>

  <h2>üåç DRF Community Timeline</h2>
  <div id="timeline"></div>

  <script src="cidList.js"></script>
  <script>
    const timeline = document.getElementById("timeline");

    async function loadTimeline() {
      for (const post of approvedCIDs) {
        const url = `https://ipfs.io/ipfs/${post.cid}/metadata.json`;

        try {
          const res = await fetch(url);
          const data = await res.json();

          const mediaURL = `https://ipfs.io/ipfs/${data.image || data.media || post.cid}`;
          const isVideo = mediaURL.endsWith(".mp4") || mediaURL.includes("video");

          const postElement = document.createElement("div");
          postElement.className = "post";
          postElement.innerHTML = `
            ${isVideo ? 
              `<video controls src="${mediaURL}"></video>` : 
              `<img src="${mediaURL}" alt="IPFS media" />`}
            <div class="description">${post.description || data.description || "No description."}</div>
            <div class="date">üìÖ ${post.date}</div>
          `;

          timeline.appendChild(postElement);

        } catch (err) {
          console.error("Failed to fetch:", post.cid, err);
        }
      }
    }

    loadTimeline();
  </script>

</body>
</html>
