<!DOCTYPE html>
<html>
<head>
  <title>Upload File to Google Drive</title>
</head>
<body>
  <h2>Upload File</h2>
  <form id="uploadForm">
    <input type="file" id="fileInput" required><br><br>
    <button type="submit">Upload</button>
  </form>

  <p id="status"></p>

  <script>
    const form = document.getElementById('uploadForm');
    const status = document.getElementById('status');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const file = document.getElementById('fileInput').files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = async () => {
        const base64 = reader.result.split(',')[1];
        const data = {
          fileName: file.name,
          mimeType: file.type,
          fileBase64: base64
        };

        const response = await fetch("https://script.google.com/macros/s/AKfycby9XhmGdvUimYCNDeBUC3SO7_WleuoWS03t-CdGllWvkE4Fyje2MzU-RjHYXwQV9cJJ/exec", {
          method: "POST",
          body: JSON.stringify({ contents: data }),
          headers: {
            "Content-Type": "application/json"
          }
        });

        const text = await response.text();
        status.innerText = text.includes("Success") ? "Upload successful!" : "Upload failed!";
      };
      reader.readAsDataURL(file);
    });
  </script>
</body>
</html>
